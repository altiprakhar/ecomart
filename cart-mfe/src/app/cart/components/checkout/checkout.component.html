<div class="checkout-container">
    <div class="checkout-header">
      <button (click)="goBack()" class="back-btn">‚Üê Back to Cart</button>
      <h1>Checkout</h1>
    </div>
  
    <div class="checkout-content">
      <!-- Checkout Form -->
      <div class="checkout-form">
        <form [formGroup]="checkoutForm" (ngSubmit)="onSubmit()">
          <!-- Personal Information -->
          <div class="form-section">
            <h2>Personal Information</h2>
            
            <div class="form-row">
              <div class="form-group">
                <label for="firstName">First Name *</label>
                <input
                  type="text"
                  id="firstName"
                  formControlName="firstName"
                  [class.invalid]="f['firstName'].invalid && f['firstName'].touched"
                />
                <span class="error" *ngIf="f['firstName'].invalid && f['firstName'].touched">
                  First name is required (min 2 characters)
                </span>
              </div>
  
              <div class="form-group">
                <label for="lastName">Last Name *</label>
                <input
                  type="text"
                  id="lastName"
                  formControlName="lastName"
                  [class.invalid]="f['lastName'].invalid && f['lastName'].touched"
                />
                <span class="error" *ngIf="f['lastName'].invalid && f['lastName'].touched">
                  Last name is required (min 2 characters)
                </span>
              </div>
            </div>
  
            <div class="form-row">
              <div class="form-group">
                <label for="email">Email *</label>
                <input
                  type="email"
                  id="email"
                  formControlName="email"
                  [class.invalid]="f['email'].invalid && f['email'].touched"
                />
                <span class="error" *ngIf="f['email'].invalid && f['email'].touched">
                  Valid email is required
                </span>
              </div>
  
              <div class="form-group">
                <label for="phone">Phone *</label>
                <input
                  type="tel"
                  id="phone"
                  formControlName="phone"
                  placeholder="1234567890"
                  [class.invalid]="f['phone'].invalid && f['phone'].touched"
                />
                <span class="error" *ngIf="f['phone'].invalid && f['phone'].touched">
                  10-digit phone number required
                </span>
              </div>
            </div>
          </div>
  
          <!-- Shipping Address -->
          <div class="form-section">
            <h2>Shipping Address</h2>
  
            <div class="form-group full-width">
              <label for="address">Street Address *</label>
              <input
                type="text"
                id="address"
                formControlName="address"
                [class.invalid]="f['address'].invalid && f['address'].touched"
              />
              <span class="error" *ngIf="f['address'].invalid && f['address'].touched">
                Address is required (min 10 characters)
              </span>
            </div>
  
            <div class="form-row">
              <div class="form-group">
                <label for="city">City *</label>
                <input
                  type="text"
                  id="city"
                  formControlName="city"
                  [class.invalid]="f['city'].invalid && f['city'].touched"
                />
                <span class="error" *ngIf="f['city'].invalid && f['city'].touched">
                  City is required
                </span>
              </div>
  
              <div class="form-group">
                <label for="state">State *</label>
                <input
                  type="text"
                  id="state"
                  formControlName="state"
                  [class.invalid]="f['state'].invalid && f['state'].touched"
                />
                <span class="error" *ngIf="f['state'].invalid && f['state'].touched">
                  State is required
                </span>
              </div>
  
              <div class="form-group">
                <label for="zipCode">ZIP Code *</label>
                <input
                  type="text"
                  id="zipCode"
                  formControlName="zipCode"
                  placeholder="12345"
                  [class.invalid]="f['zipCode'].invalid && f['zipCode'].touched"
                />
                <span class="error" *ngIf="f['zipCode'].invalid && f['zipCode'].touched">
                  Valid ZIP code required
                </span>
              </div>
            </div>
          </div>
  
          <!-- Payment Information -->
          <div class="form-section">
            <h2>Payment Information</h2>
  
            <div class="form-group full-width">
              <label for="cardNumber">Card Number *</label>
              <input
                type="text"
                id="cardNumber"
                formControlName="cardNumber"
                placeholder="1234567890123456"
                maxlength="16"
                [class.invalid]="f['cardNumber'].invalid && f['cardNumber'].touched"
              />
              <span class="error" *ngIf="f['cardNumber'].invalid && f['cardNumber'].touched">
                16-digit card number required
              </span>
            </div>
  
            <div class="form-row">
              <div class="form-group">
                <label for="cardExpiry">Expiry Date *</label>
                <input
                  type="text"
                  id="cardExpiry"
                  formControlName="cardExpiry"
                  placeholder="MM/YY"
                  [class.invalid]="f['cardExpiry'].invalid && f['cardExpiry'].touched"
                />
                <span class="error" *ngIf="f['cardExpiry'].invalid && f['cardExpiry'].touched">
                  Format: MM/YY
                </span>
              </div>
  
              <div class="form-group">
                <label for="cardCVV">CVV *</label>
                <input
                  type="text"
                  id="cardCVV"
                  formControlName="cardCVV"
                  placeholder="123"
                  maxlength="4"
                  [class.invalid]="f['cardCVV'].invalid && f['cardCVV'].touched"
                />
                <span class="error" *ngIf="f['cardCVV'].invalid && f['cardCVV'].touched">
                  3-4 digit CVV required
                </span>
              </div>
            </div>
          </div>
  
          <button 
            type="submit" 
            class="submit-btn"
            [disabled]="submitting"
          >
            {{ submitting ? 'Processing...' : 'Place Order - $' + (total | number: '1.2-2') }}
          </button>
        </form>
      </div>
  
      <!-- Order Summary Sidebar -->
      <div class="order-summary-sidebar">
        <h2>Order Summary</h2>
  
        <div class="summary-items">
          <div *ngFor="let item of cartItems" class="summary-item">
            <img [src]="item.thumbnail" [alt]="item.title" />
            <div class="item-info">
              <p class="item-name">{{ item.title }}</p>
              <p class="item-qty">Qty: {{ item.quantity }}</p>
            </div>
            <p class="item-price">${{ item.discountedTotal | number: '1.2-2' }}</p>
          </div>
        </div>
  
        <div class="summary-totals">
          <div class="summary-row">
            <span>Subtotal:</span>
            <span>${{ subtotal | number: '1.2-2' }}</span>
          </div>
  
          <div class="summary-row discount" *ngIf="discount > 0">
            <span>Discount:</span>
            <span>-${{ discount | number: '1.2-2' }}</span>
          </div>
  
          <div class="summary-row">
            <span>Tax:</span>
            <span>${{ tax | number: '1.2-2' }}</span>
          </div>
  
          <div class="summary-row">
            <span>Shipping:</span>
            <span>${{ shipping | number: '1.2-2' }}</span>
          </div>
  
          <div class="summary-divider"></div>
  
          <div class="summary-row total">
            <span>Total:</span>
            <span>${{ total | number: '1.2-2' }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>